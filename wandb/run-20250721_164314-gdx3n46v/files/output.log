Using LocalLogger is deprecated. The constructor API will change
[36m(pid=7802)[0m /root/miniconda3/envs/zerosearch/lib/python3.9/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=7802)[0m No module named 'vllm._version'
[36m(pid=7802)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(pid=8013)[0m /root/miniconda3/envs/zerosearch/lib/python3.9/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=8013)[0m No module named 'vllm._version'
[36m(pid=8013)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(pid=8009)[0m /root/miniconda3/envs/zerosearch/lib/python3.9/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:
[36m(pid=8009)[0m No module named 'vllm._version'
[36m(pid=8009)[0m   from vllm.version import __version__ as VLLM_VERSION
[36m(WorkerDict pid=8009)[0m /fs-computility/mabasic/fanyuchen/Rethink-Search/ZeroSearch/verl/utils/tokenizer.py:29: UserWarning: tokenizer.pad_token_id is None. Now set to 128009
[36m(WorkerDict pid=8009)[0m   warnings.warn(f'tokenizer.pad_token_id is None. Now set to {tokenizer.eos_token_id}')
[36m(WorkerDict pid=8009)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=7802)[0m Model config after override: LlamaConfig {
[36m(WorkerDict pid=7802)[0m   "_name_or_path": "/fs-computility/mabasic/shared/models/Llama-3.2-3B-Instruct",
[36m(WorkerDict pid=7802)[0m   "architectures": [
[36m(WorkerDict pid=7802)[0m     "LlamaForCausalLM"
[36m(WorkerDict pid=7802)[0m   ],
[36m(WorkerDict pid=7802)[0m   "attention_bias": false,
[36m(WorkerDict pid=7802)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=7802)[0m   "bos_token_id": 128000,
[36m(WorkerDict pid=7802)[0m   "eos_token_id": 128009,
[36m(WorkerDict pid=7802)[0m   "head_dim": 128,
[36m(WorkerDict pid=7802)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=7802)[0m   "hidden_size": 3072,
[36m(WorkerDict pid=7802)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=7802)[0m   "intermediate_size": 8192,
[36m(WorkerDict pid=7802)[0m   "max_position_embeddings": 131072,
[36m(WorkerDict pid=7802)[0m   "mlp_bias": false,
[36m(WorkerDict pid=7802)[0m   "model_type": "llama",
[36m(WorkerDict pid=7802)[0m   "num_attention_heads": 24,
[36m(WorkerDict pid=7802)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=7802)[0m   "num_key_value_heads": 8,
[36m(WorkerDict pid=7802)[0m   "pad_token_id": 128009,
[36m(WorkerDict pid=7802)[0m   "pretraining_tp": 1,
[36m(WorkerDict pid=7802)[0m   "rms_norm_eps": 1e-05,
[36m(WorkerDict pid=7802)[0m   "rope_scaling": {
[36m(WorkerDict pid=7802)[0m     "factor": 32.0,
[36m(WorkerDict pid=7802)[0m     "high_freq_factor": 4.0,
[36m(WorkerDict pid=7802)[0m     "low_freq_factor": 1.0,
[36m(WorkerDict pid=7802)[0m     "original_max_position_embeddings": 8192,
[36m(WorkerDict pid=7802)[0m     "rope_type": "llama3"
[36m(WorkerDict pid=7802)[0m   },
[36m(WorkerDict pid=7802)[0m   "rope_theta": 500000.0,
[36m(WorkerDict pid=7802)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=7802)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=7802)[0m   "transformers_version": "4.47.1",
[36m(WorkerDict pid=7802)[0m   "use_cache": true,
[36m(WorkerDict pid=7802)[0m   "vocab_size": 128256
[36m(WorkerDict pid=7802)[0m }
[36m(WorkerDict pid=7802)[0m
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  3.43it/s]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  3.91it/s]
[36m(WorkerDict pid=7802)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=7802)[0m LlamaForCausalLM contains 3.21B parameters
[36m(WorkerDict pid=7802)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f99afcec940>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f99afcec820>, transformer_layer_cls={<class 'transformers.models.llama.modeling_llama.LlamaDecoderLayer'>})])
[36m(WorkerDict pid=7802)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=8011)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f7d3308d940>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f7d3308d820>, transformer_layer_cls={<class 'transformers.models.llama.modeling_llama.LlamaDecoderLayer'>})])[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=8009)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in LlamaForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(pid=8010)[0m /root/miniconda3/envs/zerosearch/lib/python3.9/site-packages/vllm/connections.py:8: RuntimeWarning: Failed to read commit hash:[32m [repeated 5x across cluster][0m
[36m(pid=8010)[0m No module named 'vllm._version'[32m [repeated 5x across cluster][0m
[36m(pid=8010)[0m   from vllm.version import __version__ as VLLM_VERSION[32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=8009)[0m /fs-computility/mabasic/fanyuchen/Rethink-Search/ZeroSearch/verl/utils/tokenizer.py:29: UserWarning: tokenizer.pad_token_id is None. Now set to 128009[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=8009)[0m   warnings.warn(f'tokenizer.pad_token_id is None. Now set to {tokenizer.eos_token_id}')[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=8008)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.06it/s][32m [repeated 7x across cluster][0m
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  5.64it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=7802)[0m Model config after override: LlamaConfig {
[36m(WorkerDict pid=7802)[0m   "_name_or_path": "/fs-computility/mabasic/shared/models/Llama-3.2-3B-Instruct",
[36m(WorkerDict pid=7802)[0m   "architectures": [
[36m(WorkerDict pid=7802)[0m     "LlamaForCausalLM"
[36m(WorkerDict pid=7802)[0m   ],
[36m(WorkerDict pid=7802)[0m   "attention_bias": false,
[36m(WorkerDict pid=7802)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=7802)[0m   "bos_token_id": 128000,
[36m(WorkerDict pid=7802)[0m   "eos_token_id": 128009,
[36m(WorkerDict pid=7802)[0m   "head_dim": 128,
[36m(WorkerDict pid=7802)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=7802)[0m   "hidden_size": 3072,
[36m(WorkerDict pid=7802)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=7802)[0m   "intermediate_size": 8192,
[36m(WorkerDict pid=7802)[0m   "max_position_embeddings": 131072,
[36m(WorkerDict pid=7802)[0m   "mlp_bias": false,
[36m(WorkerDict pid=7802)[0m   "model_type": "llama",
[36m(WorkerDict pid=7802)[0m   "num_attention_heads": 24,
[36m(WorkerDict pid=7802)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=7802)[0m   "num_key_value_heads": 8,
[36m(WorkerDict pid=7802)[0m   "pad_token_id": 128009,
[36m(WorkerDict pid=7802)[0m   "pretraining_tp": 1,
[36m(WorkerDict pid=7802)[0m   "rms_norm_eps": 1e-05,
[36m(WorkerDict pid=7802)[0m   "rope_scaling": {
[36m(WorkerDict pid=7802)[0m     "factor": 32.0,
[36m(WorkerDict pid=7802)[0m     "high_freq_factor": 4.0,
[36m(WorkerDict pid=7802)[0m     "low_freq_factor": 1.0,
[36m(WorkerDict pid=7802)[0m     "original_max_position_embeddings": 8192,
[36m(WorkerDict pid=7802)[0m     "rope_type": "llama3"
[36m(WorkerDict pid=7802)[0m   },
[36m(WorkerDict pid=7802)[0m   "rope_theta": 500000.0,
[36m(WorkerDict pid=7802)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=7802)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=7802)[0m   "transformers_version": "4.47.1",
[36m(WorkerDict pid=7802)[0m   "use_cache": true,
[36m(WorkerDict pid=7802)[0m   "vocab_size": 128256
[36m(WorkerDict pid=7802)[0m }
[36m(WorkerDict pid=7802)[0m
[36m(WorkerDict pid=8012)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in LlamaForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=8012)[0m /fs-computility/mabasic/fanyuchen/Rethink-Search/ZeroSearch/verl/utils/tokenizer.py:29: UserWarning: tokenizer.pad_token_id is None. Now set to 128009[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=8012)[0m   warnings.warn(f'tokenizer.pad_token_id is None. Now set to {tokenizer.eos_token_id}')[32m [repeated 7x across cluster][0m
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 8x across cluster][0m
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:05<00:05,  5.96s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:06<00:06,  6.01s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:07<00:00,  3.91s/it]
[36m(WorkerDict pid=8011)[0m Actor use_remove_padding=True[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=8009)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f3650505940>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f3650505820>, transformer_layer_cls={<class 'transformers.models.llama.modeling_llama.LlamaDecoderLayer'>})])
[36m(WorkerDict pid=8007)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f8dd5885940>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f8dd5885820>, transformer_layer_cls={<class 'transformers.models.llama.modeling_llama.LlamaDecoderLayer'>})])
[36m(WorkerDict pid=7802)[0m LlamaForCausalLM contains 3.21B parameters
[36m(WorkerDict pid=8009)[0m Total steps: 13250, num_warmup_steps: 265
[36m(WorkerDict pid=7802)[0m Before building vllm rollout, memory allocated (GB): 1.4960813522338867, memory reserved (GB): 1.65234375
[36m(WorkerDict pid=8009)[0m WARNING 07-21 16:43:59 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=8011)[0m Actor use_remove_padding=True[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=7802)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f99afcec940>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f99afcec820>, transformer_layer_cls={<class 'transformers.models.llama.modeling_llama.LlamaDecoderLayer'>})])[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=8009)[0m local rank 0
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] ibvwrap.c:66 NCCL WARN Call to ibv_open_device failed
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] p2p_plugin.c:233 NCCL WARN NET/IB : Unable to open device mlx5_1
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] ibvwrap.c:66 NCCL WARN Call to ibv_open_device failed
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] p2p_plugin.c:233 NCCL WARN NET/IB : Unable to open device mlx5_2
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] ibvwrap.c:66 NCCL WARN Call to ibv_open_device failed
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] p2p_plugin.c:233 NCCL WARN NET/IB : Unable to open device mlx5_3
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] ibvwrap.c:66 NCCL WARN Call to ibv_open_device failed
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] p2p_plugin.c:233 NCCL WARN NET/IB : Unable to open device mlx5_4
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] misc/ibvwrap.cc:113 NCCL WARN Call to ibv_open_device failed
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] transport/net_ib.cc:219 NCCL WARN NET/IB : Unable to open device mlx5_1
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] misc/ibvwrap.cc:113 NCCL WARN Call to ibv_open_device failed
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] transport/net_ib.cc:219 NCCL WARN NET/IB : Unable to open device mlx5_2
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] misc/ibvwrap.cc:113 NCCL WARN Call to ibv_open_device failed
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] transport/net_ib.cc:219 NCCL WARN NET/IB : Unable to open device mlx5_3
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] misc/ibvwrap.cc:113 NCCL WARN Call to ibv_open_device failed
[36m(WorkerDict pid=8012)[0m
[36m(WorkerDict pid=8012)[0m t-20250722003756-p7bm9-worker-0:8012:8759 [0] transport/net_ib.cc:219 NCCL WARN NET/IB : Unable to open device mlx5_4
[36m(WorkerDict pid=8012)[0m NCCL version 2.20.5+cuda12.4
[36m(WorkerDict pid=8012)[0m Total steps: 13250, num_warmup_steps: 265[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8009)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8007)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8013)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8010)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8008)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=8011)[0m
[36m(WorkerDict pid=7802)[0m before init cache memory allocated: 8.074507264GB, reserved: 8.151629824GB
[36m(WorkerDict pid=7802)[0m after init cache memory allocated: 60.10065408GB, reserved: 60.17777664GB
[36m(WorkerDict pid=8011)[0m WARNING 07-21 16:44:00 config.py:380] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=8011)[0m local rank 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=8009)[0m kwargs: {'n': 1, 'logprobs': 1, 'max_tokens': 4096, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 0.95, 'ignore_eos': False}
[36m(WorkerDict pid=8009)[0m /root/miniconda3/envs/zerosearch/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:689: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=8009)[0m   warnings.warn(
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:06<00:06,  6.07s/it][32m [repeated 6x across cluster][0m
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:07<00:00,  3.98s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=7802)[0m After building vllm rollout, memory allocated (GB): 49.98839473724365, memory reserved (GB): 56.044921875
[36m(WorkerDict pid=7802)[0m After building sharding manager, memory allocated (GB): 49.98839473724365, memory reserved (GB): 56.044921875
Training:   0%|          | 0/13250 [00:00<?, ?it/s]
epoch 0, step 1
[2025-07-21 16:44:53,733][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:53,810][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:53,853][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:53,931][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:54,044][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:54,218][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:54,227][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:54,296][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:54,305][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:54,799][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:54,816][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,020][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,021][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,132][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,306][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,437][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,446][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,462][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,615][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,653][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:55,981][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:56,016][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:56,335][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:56,423][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:56,441][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:56,692][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:56,893][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:57,035][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:57,105][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:57,289][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:57,377][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:57,438][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:57,568][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:57,718][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:57,770][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,007][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,033][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,050][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,118][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,215][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,513][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,604][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,736][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,818][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,844][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,959][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,959][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:58,967][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:59,193][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:59,642][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:59,695][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:59,764][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:59,792][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:44:59,896][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:00,097][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:00,221][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:00,513][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:00,575][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:00,716][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:00,753][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:00,761][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:00,787][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:00,918][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:01,005][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:01,155][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:01,441][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:01,593][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:01,601][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:01,743][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:01,884][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:02,086][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:02,095][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:02,178][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:02,336][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:02,608][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:02,732][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:02,740][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:02,919][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:03,086][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:03,104][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:03,157][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:03,166][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:03,367][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:03,446][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:03,447][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:03,840][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:03,883][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:04,009][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:04,079][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:04,184][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:04,193][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:04,201][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:04,241][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:04,460][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:04,539][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:04,818][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:05,027][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:05,089][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:05,272][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:05,385][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:05,452][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:05,722][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:05,863][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:05,896][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:05,951][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:06,135][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:08,325][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:45:08,332][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:30,454][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:30,561][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:30,705][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:30,724][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:30,871][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:30,994][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:31,172][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:31,266][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:31,400][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:31,795][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:31,831][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:31,839][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:31,847][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:32,054][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:32,071][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:32,192][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:32,200][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:32,358][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:32,394][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:32,500][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:32,661][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:32,784][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,030][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,031][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,117][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,241][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,258][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,357][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,357][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,508][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,578][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:33,684][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,117][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,250][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,295][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,383][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,428][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,428][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,528][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,529][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,555][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:34,950][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:35,022][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:35,108][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:35,268][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:35,312][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:35,396][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:35,574][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:35,780][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:36,361][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:36,654][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:36,796][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:36,832][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:36,833][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:36,859][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:36,995][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:37,085][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:37,254][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:37,683][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:37,700][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:38,040][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:38,378][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:38,594][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:39,072][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:39,359][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:39,447][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:39,448][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:46:43,151][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,540][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,576][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,599][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,612][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,618][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,683][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,736][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,745][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,770][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,790][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,858][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:06,919][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,042][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,051][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,139][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,192][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,192][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,282][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,353][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,362][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,401][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,423][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,635][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,789][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,798][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,849][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,928][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,954][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,998][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,999][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:07,999][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:08,076][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:08,309][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:08,615][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:48:09,028][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:32,668][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:32,687][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:32,697][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:32,730][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:32,751][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:32,831][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:32,839][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:32,840][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,029][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,152][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,161][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,330][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,348][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,427][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,489][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,542][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,639][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,694][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,839][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:33,909][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:34,010][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:34,174][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:34,308][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:34,812][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:40,601][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:49:40,623][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,097][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,098][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,126][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,279][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,280][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,289][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,663][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,673][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,821][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,857][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:06,887][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:07,116][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:07,169][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:07,363][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:07,397][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:07,824][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:07,879][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:08,243][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
[2025-07-21 16:51:09,048][httpx][INFO] - HTTP Request: POST http://172.30.52.145:8001/v1/chat/completions "HTTP/1.1 200 OK"
Error executing job with overrides: ['algorithm.adv_estimator=grpo', "data.train_files=['/fs-computility/mabasic/fanyuchen/Rethink-Search_tmp/verl_temp/ZeroSearch_dataset/train.parquet']", "data.val_files=['/fs-computility/mabasic/fanyuchen/Rethink-Search_tmp/verl_temp/ZeroSearch_dataset/test.parquet']", 'data.train_batch_size=64', 'data.max_prompt_length=1024', 'data.max_response_length=4096', 'actor_rollout_ref.model.path=/fs-computility/mabasic/shared/models/Llama-3.2-3B-Instruct', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.model.use_remove_padding=True', 'actor_rollout_ref.actor.ppo_mini_batch_size=256', 'actor_rollout_ref.actor.ppo_micro_batch_size=128', 'actor_rollout_ref.rollout.log_prob_micro_batch_size=128', 'actor_rollout_ref.actor.use_kl_loss=True', 'actor_rollout_ref.actor.kl_loss_coef=0.001', 'actor_rollout_ref.actor.kl_loss_type=low_var_kl', 'actor_rollout_ref.actor.entropy_coeff=0', 'actor_rollout_ref.model.enable_gradient_checkpointing=True', 'actor_rollout_ref.actor.fsdp_config.param_offload=True', 'actor_rollout_ref.actor.optim.lr_warmup_steps_ratio=0.02', 'actor_rollout_ref.actor.fsdp_config.optimizer_offload=True', 'actor_rollout_ref.ref.log_prob_micro_batch_size=128', 'actor_rollout_ref.rollout.tensor_model_parallel_size=1', 'actor_rollout_ref.rollout.name=vllm', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.7', 'actor_rollout_ref.rollout.n_agent=2', 'actor_rollout_ref.ref.fsdp_config.param_offload=True', 'trainer.val_before_train=False', 'trainer.critic_warmup=0', 'trainer.logger=[console,wandb]', 'trainer.project_name=Rethink Search Scaling', 'trainer.experiment_name=llama_3.1_8b_inst_grpo_init', 'trainer.n_gpus_per_node=8', 'trainer.val_before_train=False', 'trainer.nnodes=1', 'trainer.save_freq=10000', 'trainer.test_freq=16', 'trainer.total_epochs=5']
Traceback (most recent call last):
  File "/fs-computility/mabasic/fanyuchen/Rethink-Search/ZeroSearch/verl/trainer/main_ppo.py", line 156, in main
    main_task(config)
  File "/fs-computility/mabasic/fanyuchen/Rethink-Search/ZeroSearch/verl/trainer/main_ppo.py", line 229, in main_task
    trainer.fit()
  File "/fs-computility/mabasic/fanyuchen/Rethink-Search/ZeroSearch/verl/trainer/ppo/ray_trainer.py", line 769, in fit
    final_gen_batch_output, trajectory_turns = generation_manager.run_llm_loop(
  File "/fs-computility/mabasic/fanyuchen/Rethink-Search/ZeroSearch/llm_agent/generation.py", line 466, in run_llm_loop
    final_responses[idx, :full_response.shape[0]] = full_response
RuntimeError: The expanded size of the tensor (4096) must match the existing size (4252) at non-singleton dimension 0.  Target sizes: [4096].  Tensor sizes: [4252]

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
